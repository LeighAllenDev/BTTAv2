{% extends 'base.html' %}
{% url 'account_login' as login_url %}
{% url 'account_signup' as signup_url %}
{% block content %}

<h1>Book Your Visit Now!</h1>

<p>Choose from our bundles,<br>
    select your desired food and drinks,<br>
    then confirm your booking.<br>
    We look forward to seeing you soon!</p>

{% if user.is_authenticated %}
<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <div id="token-info"></div>
    <button type="submit">Book Now</button>
</form>
{% else %}
<p>Please <a href="{% url 'account_login' %}?next={{ request.path }}">sign in</a> or <a href="{% url 'account_signup' %}">register</a> to make a booking.</p>
{% endif %}

<script>
    document.getElementById("id_bundle").addEventListener("change", function() {
        const bundleId = this.value;
        // Example AJAX call to get bundle details
        fetch(`/api/bundles/${bundleId}/`)
            .then(response => response.json())
            .then(data => {
                document.getElementById("token-info").innerHTML = `Food Tokens: ${data.food_tokens}, Drink Tokens: ${data.drink_tokens}`;
                // Further logic to update the form based on selected bundle
            });
    });
    </script>
{% endblock %}